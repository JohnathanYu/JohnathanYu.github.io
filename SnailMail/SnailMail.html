<!DOCTYPE html>
<html>

<head>
<title> John Yu: Snail Mail</title>
</head>

<body>
<h1>Welcome to Snail Mail!
</h1>
</body>


<body>
<div id="dialogDisplay">It's a beautiful day today!</div>

<div id="snailsDisplay">Snails: 0</div>

<button onclick="huntSnail()">hunt a snail</button>
<div id="wildSnailsDisplay" style="display:none">Snails in the wild: 100/100</div>
<br>

<button id="buildFarmButton" onclick="buildFarm()" style="display:none">Build the Snail Farm</button>
<div id="farmBuildProgressDisplay" style="display:none">Snails needed to build farm: 0/150</div>
<br id = "farmBuildLineBreak" style="display:none">

<button id="plantSnailButton" onclick="plantSnail()" style="display:none">Add a snail to the farm</button>
<div id="farmSnailsDisplay" style="display:none">Snails in the farm: 0</div>
<br id = "farmSnailsLineBreak" style="display:none">


<div id="snailsDeltaDisplay" style="display:none">DELTA</div>
<button onclick="activateTestButton()">Test Button</button>




<script>
var snails = 0;
var totalAquiredSnails = 0;

var wildSnails = 100;
var wildSnailsMax = 100;
var wildSnailsBaseGrowth = .1;

var farmBuildProgress = 0;
var farmBuildProgressMax = 150;

//flags
var displayWildSnailsFlag = false;
var suggestBuildingFarmFlag = false;
var farmFullyBuiltFlag = false;


setInterval(secondTick, 1000);

function secondTick() {
  if(wildSnails < wildSnailsMax) {
    var wildSnailsDelta = wildSnailsBaseGrowth * wildSnails * ((wildSnailsMax -                    wildSnails) / wildSnailsMax)
    document.getElementById("snailsDeltaDisplay").innerHTML = "Delta: " + wildSnailsDelta;
    if (wildSnailsDelta > 1) {
      wildSnails += wildSnailsDelta;
    } else {
      wildSnails++;
    }
    if (wildSnails > wildSnailsMax) {
      wildSnails = wildSnailsMax;
    }
    updateWildSnailsText();
  }
}

function huntSnail() {
  if(wildSnails >= 1) {
    wildSnails--;
    updateWildSnailsText();
    gainSnails(1);
  } else if(displayWildSnailsFlag == false){
  	 document.getElementById("dialogDisplay").innerHTML = "Looks like there aren't any snails today. Maybe the snails need a while to reproduce.";
     document.getElementById('wildSnailsDisplay').style.display='inline'
     displayWildSnailsFlag = true;
  }
}

function buildFarm() {
  if(snails >= 1) {
    loseSnails(1);
    farmBuildProgress++;
    updateFarmBuildProgressText();
    if(farmBuildProgress >= farmBuildProgressMax) {
      document.getElementById("dialogDisplay").innerHTML = "Somehow, your crude pile of live snails has become sturdy enough to house other live snails.";
      document.getElementById('buildFarmButton').style.display='none';
      document.getElementById('farmBuildProgressDisplay').style.display='none';
      document.getElementById('farmBuildLineBreak').style.display='none';
      
      document.getElementById('plantSnailButton').style.display='inline';
      document.getElementById('farmSnailsDisplay').style.display='inline';
      document.getElementById('farmSnailsLineBreak').style.display='inline';
      farmFullyBuiltFlag = true;
    }
  }
  
}


function gainSnails(snailsToGain) {
  snails += snailsToGain;
  totalAquiredSnails += snailsToGain;
  updateCurrentSnailsText();
  
  //Consider flags, given the total aquired snails
  if (suggestBuildingFarmFlag == false && totalAquiredSnails >= 150) {
    document.getElementById("dialogDisplay").innerHTML = "Perhaps you could build a snail farm to collect snails more efficiently.";
    document.getElementById('buildFarmButton').style.display='inline';
    document.getElementById('farmBuildProgressDisplay').style.display='inline';
    document.getElementById('farmBuildLineBreak').style.display='inline';
    suggestBuildingFarmFlag = true;
  }
}

function loseSnails(snailsToLose) {
  snails -= snailsToLose;
  updateCurrentSnailsText();
}




function updateWildSnailsText() {
  document.getElementById("wildSnailsDisplay").innerHTML = "Snails in the wild: " 
    + Math.floor(wildSnails) + "/" + wildSnailsMax;
}

function updateCurrentSnailsText() {
  document.getElementById("snailsDisplay").innerHTML = "Snails: " + snails;
}

function updateFarmBuildProgressText() {
  document.getElementById("farmBuildProgressDisplay").innerHTML = "Snails needed to build farm: " + farmBuildProgress + "/" + farmBuildProgressMax;
}


function activateTestButton() {
  gainSnails(49);
}

</script>
</body>

<body>
<div style="position: fixed; bottom: 0px; left: 15px; font-size: 14px;">
<p>Pro tip: Snails are very cool.</p>
Version 1.7
</div>
</body>


</html>